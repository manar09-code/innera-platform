<div class="profile-wrapper">
  <div class="profile-header-section">
    <button class="btn-back" (click)="goBack()">Back</button>
    <h1 class="page-title">Profile</h1>
  </div>

  <div class="profile-container">
    <!-- Header/Background Section -->
    <div class="profile-header" [style.background-image]="backgroundImage">
      <div class="profile-picture">
        {{ profilePicture }}
      </div>
      <h1 class="community-name">{{ displayCommunityName }}</h1>
    </div>

    <!-- Main Content -->
    <div class="profile-content">
      <!-- User Info Section (Center) -->
      <div class="user-info">
        <h2 class="section-subtitle">Account Details</h2>
        <div class="info-item">
          <label>Username</label>
          <div class="info-content">
            @if (!editingUsername) {
              <span>{{ userName || 'Not set' }}</span>
            }
            @if (editingUsername) {
              <input [(ngModel)]="tempUsername" type="text" placeholder="Enter username" />
            }
          </div>
          <div class="info-actions">
            @if (!editingUsername) {
              <button class="btn-edit" (click)="startEdit('Username')">Edit</button>
            }
            @if (editingUsername) {
              <button class="btn-save" (click)="saveEdit('Username')">Save</button>
            }
            @if (editingUsername) {
              <button class="btn-cancel" (click)="cancelEdit('Username')">Cancel</button>
            }
          </div>
        </div>

        <div class="info-item">
          <label>Email</label>
          <div class="info-content">
            @if (!editingEmail) {
              <span>{{ userEmail || 'Not set' }}</span>
            }
            @if (editingEmail) {
              <input [(ngModel)]="tempEmail" type="email" placeholder="Enter email" />
            }
          </div>
          <div class="info-actions">
            @if (!editingEmail) {
              <button class="btn-edit" (click)="startEdit('Email')">Edit</button>
            }
            @if (editingEmail) {
              <button class="btn-save" (click)="saveEdit('Email')">Save</button>
            }
            @if (editingEmail) {
              <button class="btn-cancel" (click)="cancelEdit('Email')">Cancel</button>
            }
          </div>
        </div>

        <div class="info-item">
          <label>Community</label>
          <div class="info-content">
            @if (!editingCommunity) {
              <span>{{ displayCommunityName }}</span>
            }
            @if (editingCommunity) {
              <input [(ngModel)]="tempCommunity" type="text" placeholder="Enter community" />
            }
          </div>
          <div class="info-actions">
            @if (!editingCommunity) {
              <button class="btn-edit" (click)="startEdit('Community')">Edit</button>
            }
            @if (editingCommunity) {
              <button class="btn-save" (click)="saveEdit('Community')">Save</button>
            }
            @if (editingCommunity) {
              <button class="btn-cancel" (click)="cancelEdit('Community')">Cancel</button>
            }
          </div>
        </div>

        <div class="info-item password-item">
          <label>Password</label>
          <div class="info-content">
            @if (!editingPassword) {
              <span>{{ userPassword }}</span>
            }
            @if (editingPassword) {
              <input [(ngModel)]="tempPassword" type="password"
                placeholder="Enter new password" />
            }
          </div>
          <div class="info-actions">
            @if (!editingPassword) {
              <button class="btn-edit" (click)="startEdit('Password')">Edit</button>
            }
            @if (editingPassword) {
              <button class="btn-save" (click)="saveEdit('Password')">Save</button>
            }
            @if (editingPassword) {
              <button class="btn-cancel" (click)="cancelEdit('Password')">Cancel</button>
            }
          </div>
        </div>

        <button class="logout-btn" (click)="logout()">Logout</button>
      </div>

      <!-- Right Sidebar -->
      <div class="right-sidebar">
        <div class="sidebar-group">
          <a href="#" (click)="$event.preventDefault(); navigateToHistory()" class="main-link history-link">
            <span class="icon">ðŸ“œ</span> History
          </a>

          <!-- Admin Sub-links nested logic -->
          @if (isAdmin) {
            <div class="admin-controls">
              <div class="admin-divider">Admin Dashboard</div>
              <a href="#" (click)="$event.preventDefault(); navigateToStats()" class="sub-link stats-link">
                <span class="icon">ðŸ“Š</span> Pages Stats
              </a>
              <a href="#" (click)="$event.preventDefault(); navigateToDashboard()" class="sub-link dashboard-link">
                <span class="icon">ðŸ‘¥</span> User Management
              </a>
              <a href="#" (click)="$event.preventDefault(); navigateToConfigAi()" class="sub-link config-ai-link">
                <span class="icon">ðŸ¤–</span> Config AI
              </a>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Bottom Section -->
    <div class="bottom-section">
      <div class="stats-item">
        <h3>Number of Likes</h3>
        <p>{{ userLikes.length }}</p>
      </div>
      <div class="stats-item">
        <h3>Number of Comments</h3>
        <p>{{ userComments.length }}</p>
      </div>
      <div class="stats-item">
        <h3>Number of Posts</h3>
        <p>{{ userPosts.length }}</p>
      </div>
    </div>
  </div>
</div>