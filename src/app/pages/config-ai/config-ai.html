<div class="config-ai-wrapper">
  <div class="config-ai-header">
    <button class="btn-back" (click)="goBack()">Back</button>
    <h1 class="page-title">Configure AI Assistant & Community</h1>
  </div>

  <div class="config-ai-container">

    <!-- Community Information Section -->
    <div class="section">
      <h3>Community Information</h3>
      <form [formGroup]="communityForm" (ngSubmit)="saveCommunityInfo()">
        <div class="form-group">
          <label for="communityDescription">Community Description:</label>
          <textarea id="communityDescription" formControlName="description" rows="4"
          placeholder="Describe your community..."></textarea>
        </div>
        <div class="form-group">
          <label for="communityRules">Community Rules:</label>
          <textarea id="communityRules" formControlName="rules" rows="6"
          placeholder="List the rules for your community..."></textarea>
        </div>
        <div class="form-group">
          <label for="memberCount">Member Count:</label>
          <input id="memberCount" type="number" formControlName="memberCount"
            placeholder="Enter current member count" />
          </div>
          <button type="submit" [disabled]="!communityForm.valid">Save Community Info</button>
        </form>
      </div>

      <!-- AI Instructions Section -->
      <div class="section">
        <h3>AI Assistant Instructions</h3>
        <form [formGroup]="configForm" (ngSubmit)="saveAiConfig()">
          <div class="form-group">
            <label for="instructions">AI Instructions (System Prompt):</label>
            <textarea id="instructions" formControlName="instructions" rows="6"
            placeholder="Enter behavior instructions for the AI..."></textarea>
          </div>
          <div class="form-group">
            <label for="news">Community News:</label>
            <textarea id="news" formControlName="news" rows="6"
            placeholder="Enter latest community news (events, updates, etc.)..."></textarea>
          </div>
          <div class="form-group">
            <label for="openaiKey">Google Gemini API Key (Free Tier):</label>
            <input id="openaiKey" type="password" formControlName="openaiKey" placeholder="AIza..." />
            <small style="color: #ccc; display: block; margin-top: 5px;">
              Get your free key at <a href="https://aistudio.google.com/app/apikey" target="_blank"
            style="color: #007bff;">Google AI Studio</a>.
          </small>
        </div>
        <button type="submit" [disabled]="!configForm.valid">Save AI Configuration</button>
      </form>
    </div>

    <!-- Saved Information Display -->
    <div class="saved-info">
      @if (savedInstructions) {
        <div class="saved-instructions">
          <h3>Current AI Instructions:</h3>
          <p>{{ savedInstructions }}</p>
        </div>
      }
      @if (savedCommunityInfo) {
        <div class="saved-community">
          <h3>Current Community Info:</h3>
          <p><strong>Description:</strong> {{ savedCommunityInfo.description }}</p>
          <p><strong>Rules:</strong> {{ savedCommunityInfo.rules }}</p>
          <p><strong>Member Count:</strong> {{ savedCommunityInfo.memberCount }}</p>
        </div>
      }
    </div>
  </div>